<div class="responsive-paddings">
	<h2>
		{{supplier.id == 0 ? 'Add' : 'Update' }} Supplier
		<dx-button class="btn-back" type="back" (onClick)="backToSuppliers()">
		</dx-button>
	</h2>

	<div class="dx-card responsive-paddings">

		<form (submit)="handleSubmit($event)">
			<dx-form id="form" [(formData)]="supplier" labelLocation="top" [colCount]="2">
				<dxi-item dataField="code" [isRequired]="true"></dxi-item>
				<dxi-item dataField="supplierName" [isRequired]="true"></dxi-item>
				<dxi-item>
					<dxo-label text="Is Active"></dxo-label>
					<dx-check-box [(value)]="supplier.active">
					</dx-check-box>
				</dxi-item>
				<dxi-item dataField="businessRegistrationId"></dxi-item>
				<dxi-item dataField="vatNumber"></dxi-item>

				<dxi-item itemType="empty" [colSpan]="2"></dxi-item>
            <dxi-item itemType="empty" [colSpan]="2"></dxi-item>
            <dxi-item itemType="group" caption="Contact information">
                <dxi-item itemType="tabbed">
                    <dxo-tab-panel-options>
                    </dxo-tab-panel-options>
                    <dxi-tab title="Contact" [colCount]="2">
                        <dxi-item dataField="contact.contactPerson" [colSpan]="2">
                            <dxo-label text="Contact Person"> </dxo-label>
                        </dxi-item>
                        <dxi-item dataField="contact.phone" [isRequired]="true">
                            <dxo-label text="Phone"> </dxo-label>
                        </dxi-item>
                        <dxi-item dataField="contact.mobile">
                            <dxo-label text="Mobile"> </dxo-label>
                        </dxi-item>
                        <dxi-item dataField="contact.email" [colSpan]="2">
                            <dxo-label text="Email"> </dxo-label>
                        </dxi-item>
                    </dxi-tab>
                    <dxi-tab title="Address" [colCount]="2">
                        <dxi-item dataField="address.firstName">
                            <dxo-label text="First Name"> </dxo-label>
                        </dxi-item>
                        <dxi-item dataField="address.lastName">
                            <dxo-label text="Last Name"> </dxo-label>
                        </dxi-item>
                        <dxi-item dataField="address.addressLine1" [isRequired]="true">
                            <dxo-label text="Address Line 1"> </dxo-label>
                        </dxi-item>
                        <dxi-item dataField="address.addressLine2">
                            <dxo-label text="Address Line 2"> </dxo-label>
                        </dxi-item>

                        <dxi-item *ngIf="supplier && supplier.address">
                            <dxo-label text="City"> </dxo-label>
                            <dx-select-box [dataSource]="cityStore" [(value)]="supplier.address.cityId"
                                displayExpr="cityName" valueExpr="id" [searchMode]="'contains'"
                                [searchExpr]="'cityName'" [searchTimeout]="200" [minSearchLength]="0"
                                [searchEnabled]="true"></dx-select-box>
                        </dxi-item>

                        <dxi-item dataField="address.postalCode" [isRequired]="true">
                            <dxo-label text="Postal Code"> </dxo-label>
                        </dxi-item>
                    </dxi-tab>
                </dxi-item>
            </dxi-item>

            <dxi-item itemType="group" caption="Supplier Charges">
                <dxi-item editorType="dxNumberBox" dataField="supplierCharges.allocatedUnits">
                    <dxo-label text="Allocated Units"> </dxo-label>
                </dxi-item>
                <dxi-item editorType="dxNumberBox" dataField="supplierCharges.storageChargePerUnit">
                    <dxo-label text="Storage Charge Per Unit"> </dxo-label>
                </dxi-item>
                <dxi-item editorType="dxNumberBox" dataField="supplierCharges.additionalChargePerUnitPrice">
                    <dxo-label text="Additional Charge Per Unit Price"> </dxo-label>
                </dxi-item>
                <dxi-item editorType="dxNumberBox" dataField="supplierCharges.handlingCharge">
                    <dxo-label text="Handling Charge"> </dxo-label>
                </dxi-item>
            </dxi-item>

            <dxi-item itemType="empty" [colSpan]="2"></dxi-item>

            <dxi-item>
                <dxo-label text="Invoice Policy"> </dxo-label>
                <dx-text-area [height]="90" [(value)]="supplier.invoicePolicy">
                </dx-text-area>
            </dxi-item>
            <dxi-item>
                <dxo-label text="Return Policy"> </dxo-label>
                <dx-text-area [height]="90" [(value)]="supplier.returnPolicy">
                </dx-text-area>
            </dxi-item>

            <dxi-item itemType="empty" [colSpan]="2"></dxi-item>
            <dxi-item itemType="empty" [colSpan]="2"></dxi-item>

            <dxi-item itemType="group" cssClass="pickup-list-address-container dx-card responsive-paddings"
                [colSpan]="2" *ngIf="supplier && supplier.pickupAddress">
                <h3>Pickup Addresses
                    <dx-button class="btn-back" text="Add" (onClick)="addPickupAddress()">
                    </dx-button>
                </h3>
                <hr />

                <dx-list id="list" [dataSource]="supplier.pickupAddress" [allowItemDeleting]="true"
                    (onItemClick)="updatePickupAddress($event)">
                    <div *dxTemplate="let item of 'item'">
                        <div>
                            <div>{{getPickupAddressDisplayStrinng(item)}}</div>
                        </div>
                    </div>
                </dx-list>
            </dxi-item>

            <dxi-item itemType="empty" [colSpan]="2"></dxi-item>
				<dxi-item itemType="empty" [colSpan]="2"></dxi-item>

				<dxi-item cssClass="btn-save-supplier" itemType="button" [colSpan]="2"
						  [buttonOptions]="{ text:'Save Changes', useSubmitBehavior: true, icon: 'save', type:'success'}">
				</dxi-item>

			</dx-form>
		</form>

	</div>
</div>

<supplier-pickup-address-modal
	[pickupAddress]="currentSupplierPickupAddress"
	(response)="supplierPickupAddressModelResponse($event)"
	[visible]="displayPickupAddressModal">
</supplier-pickup-address-modal>
