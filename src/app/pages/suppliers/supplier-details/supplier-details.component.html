<div class="responsive-paddings supplier-details">

	<div class="page-header">
		<h2>Supplier Details</h2>
		<h5>Details of supplier</h5>
		<dx-button (onClick)="backToSuppliers()" class="btn-back" text="Back to List" type="back">
		</dx-button>
	</div>

	<div>
		<h4>Supplier Details</h4>
		<dx-form [(formData)]="supplier" [readOnly]="true" id="form" labelLocation="top">
			<dxi-item itemType="tabbed">
				<dxo-tab-panel-options [animationEnabled]="true"
									   [showNavButtons]="true"
									   [deferRendering]="false">
				</dxo-tab-panel-options>
				<dxi-tab title="General" icon="icon ion-md-home" colCount="2">
					<dxi-item [isRequired]="true" dataField="code"></dxi-item>
					<dxi-item [isRequired]="true" dataField="supplierName"></dxi-item>
					<dxi-item>
						<dxo-label text="Is Active"></dxo-label>
						<dx-check-box [(value)]="supplier.active">
						</dx-check-box>
					</dxi-item>
					<dxi-item dataField="businessRegistrationId"></dxi-item>
					<dxi-item dataField="vatNumber"></dxi-item>
				</dxi-tab>
				<dxi-tab title="Contact Informations" icon="icon ion-md-card" colCount="2">
					<dxi-item [colSpan]="2"
							  [editorOptions]="{inputAttr: { autocomplete: 'contact-person-field' }}"
							  dataField="contact.contactPerson">
						<dxo-label text="Contact Person"></dxo-label>
					</dxi-item>
					<dxi-item
						[editorOptions]="{inputAttr: { autocomplete: 'phone-field' }}"
						[isRequired]="true" dataField="contact.phone">
						<dxo-label text="Phone"></dxo-label>
					</dxi-item>
					<dxi-item
						[editorOptions]="{inputAttr: { autocomplete: 'mobile-field' }}"
						dataField="contact.mobile">
						<dxo-label text="Mobile"></dxo-label>
					</dxi-item>
					<dxi-item
						[editorOptions]="{inputAttr: { autocomplete: 'email-field' }}"
						[colSpan]="2" dataField="contact.email">
						<dxo-label text="Email"></dxo-label>
					</dxi-item>
					<dxi-item
						[editorOptions]="{inputAttr: { autocomplete: 'address-first-name-field' }}"
						dataField="address.firstName">
						<dxo-label text="First Name"></dxo-label>
					</dxi-item>
					<dxi-item
						[editorOptions]="{inputAttr: { autocomplete: 'address-last-name-field' }}"
						dataField="address.lastName">
						<dxo-label text="Last Name"></dxo-label>
					</dxi-item>
					<dxi-item [isRequired]="true"
							  [editorOptions]="{inputAttr: { autocomplete: 'address-line-1-field' }}"
							  dataField="address.addressLine1">
						<dxo-label text="Address Line 1"></dxo-label>
					</dxi-item>
					<dxi-item
						[editorOptions]="{inputAttr: { autocomplete: 'address-line-2-field' }}"
						dataField="address.addressLine2">
						<dxo-label text="Address Line 2"></dxo-label>
					</dxi-item>

					<dxi-item *ngIf="supplier && supplier.address">
						<dxo-label text="City"></dxo-label>
						<dx-select-box [(value)]="supplier.address.cityId" [dataSource]="cityStore"
									   [inputAttr]="{ autocomplete : 'city-field'}"
									   [showDataBeforeSearch]="true"
									   [minSearchLength]="0" [searchEnabled]="true" [searchExpr]="'cityName'"
									   [searchMode]="'contains'" [searchTimeout]="200" displayExpr="cityName"
									   valueExpr="id"></dx-select-box>
					</dxi-item>

					<dxi-item
						[editorOptions]="{inputAttr: { autocomplete: 'postal-code-field' }}"
						[isRequired]="true" dataField="address.postalCode">
						<dxo-label text="Postal Code"></dxo-label>
					</dxi-item>

				</dxi-tab>
				<dxi-tab title="Supplier Charges" icon="icon ion-md-cash" colCount="2">
					<dxi-item dataField="supplierCharges.allocatedUnits" editorType="dxNumberBox">
						<dxo-label text="Allocated Units"></dxo-label>
					</dxi-item>
					<dxi-item dataField="supplierCharges.storageChargePerUnit" editorType="dxNumberBox">
						<dxo-label text="Storage Charge Per Unit"></dxo-label>
					</dxi-item>
					<dxi-item dataField="supplierCharges.additionalChargePerUnitPrice" editorType="dxNumberBox">
						<dxo-label text="Additional Charge Per Unit Price"></dxo-label>
					</dxi-item>
					<dxi-item dataField="supplierCharges.handlingCharge" editorType="dxNumberBox">
						<dxo-label text="Handling Charge"></dxo-label>
					</dxi-item>
				</dxi-tab>
				<dxi-tab title="Policies" icon="icon ion-md-book" colCount="2">
					<dxi-item>
						<dxo-label text="Invoice Policy"></dxo-label>
						<dx-text-area [(value)]="supplier.invoicePolicy" [height]="90">
						</dx-text-area>
					</dxi-item>
					<dxi-item>
						<dxo-label text="Return Policy"></dxo-label>
						<dx-text-area [(value)]="supplier.returnPolicy" [height]="90">
						</dx-text-area>
					</dxi-item>
				</dxi-tab>
				<dxi-tab title="Pickup Address" icon="icon ion-md-car">
					<dxi-item *ngIf="supplier && supplier.pickupAddress" [colSpan]="2"
							  cssClass="pickup-list-address-container dx-card responsive-paddings" itemType="group">
						<dx-list [dataSource]="supplier.pickupAddress"
								 id="list">
							<div *dxTemplate="let item of 'item'">
								<div>
									<div>{{getPickupAddressDisplayStrinng(item)}}</div>
								</div>
							</div>
						</dx-list>
					</dxi-item>
				</dxi-tab>

			</dxi-item>
		</dx-form>
	</div>

	<div>
		<h4>Supplier Account Details</h4>

		<dx-button
			icon="icon ion-md-person-add"
			stylingMode="outlined"
			type="normal"
			(onClick)="createAccount()"
			text="Create Account">
		</dx-button>

		<br/><br/>

		<dx-data-grid [columnAutoWidth]="true"
					  [columnHidingEnabled]="true"
					  [visible]="supplier != null"
					  [dataSource]="userDataSource"
					  [remoteOperations]="true" [showBorders]="true" class="dx-card wide-card"
					  keyExpr="Id">
			<dxo-paging [pageSize]="10"></dxo-paging>
			<dxo-pager [showInfo]="true" [showPageSizeSelector]="true"></dxo-pager>
			<dxo-filter-row [visible]="false"></dxo-filter-row>
			<dxi-column caption="User Name" dataField="userName">
			</dxi-column>
			<dxi-column caption="Email" dataField="email">
			</dxi-column>
			<dxi-column dataField="active" [width]="100">
			</dxi-column>
			<dxi-column [width]="110" type="buttons">
				<dxi-button [visible]="isDeactivateButtonVisible" hint="Deactivate"
							cssClass="default-button"
							icon="icon ion-md-lock" [onClick]="setUserStatus"></dxi-button>
				<dxi-button [visible]="isActiveButtonVisible" hint="Active"
							cssClass="default-button"
							icon="icon ion-md-unlock" [onClick]="setUserStatus"></dxi-button>
				<dxi-button visible="true" hint="Delete" icon="icon ion-md-trash"
							cssClass="danger-button" [onClick]="deleteUser"></dxi-button>
			</dxi-column>
		</dx-data-grid>
	</div>

</div>

<app-create-account-popup [supplierId]="supplier.id"
						  [visible]="showCreateAccountPopup"
						  (onSuccess)="onCreateAccount()"
						  (onCancel)="onCreateAccountCancel()">
</app-create-account-popup>


